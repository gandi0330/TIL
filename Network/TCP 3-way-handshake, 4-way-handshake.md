# TCP, 3-way-handshake, 4-way-handshake


- TCP
    - 전송 제어 프로토콜(Transmission Control Protocol)
    - 전송 계층에 위치, 네트워크의 정보 전달을 통제하는 프로토콜이자 인터넷을 이루는 핵심 프로토콜
    - 통신하고자 하는 양쪽 단말이 통신할 준비가 되었는지, 데이터가 제대로 전송 되었는지, 데이터가 가는 도중 변질되지 않았는지, 수신자가 얼마나 받았고 빠진 부분은 없는지를 점검
    - 이러한 정보들을 TCP Header에 담음
    - 주요 기능
        - 흐름제어
            - 데이터를 얼마나 보낼 수 있는지, 얼마나 데이터를 어디까지 받았는지를 끊임없이 확인한다.
            - TCP Header의 window size를 통해 한번에 받고 보낼 수 있는 데이터 양을 정한다
            - window size는 받는 측이 정하고 (3-way handshake때 정함) 상황에 따라 조절한다
        - 혼잡제어
            - slow start : 연결 경로 사이에 네트워크가 혼잡할 수 있으므로 한번에 보낼 수 있는 만큼 데이터를 모두 보내지 않고 적은 데이터를 보내며 수신자의 수신을 확인하고 데이터량을 조금씩 늘린다
    - TCP를 기반으로 하는 어플리케이션 프로토콜 : HTTP, FTP, SMTP등  모든 데이터가 안정적으로 보내는 것이 중요한 프로토콜은 TCP의 3-way-handshake를 거친 후 각자 프로토콜에 기반한 교환 과정을 실시함
    

- TCP 프로토콜 작동
    1. 연결 생성 (3-way-handshake)
    2. 자료 전송
    3. 연결 종료 (4-way-handshake)
    
    신뢰성 있는 연결이 생성되어야 하며, 그 후 자료를 전송하고 마지막으로 연결을 종료하면서 할당된 자원을 반납
    
    - 연결 생성
        - 3방향 핸드셰이크 사용
        - 1) 클라이언트가 서버에게 SYN 메세지를 보내서 통신이 가능한지 확인한다
        - 2) 서버가 클라이언트로부터 SYN을 받고 SYN/ACK 을 클라이언트에게 날려 통신할 준비가 되었음을 알린다
        - 3) 클라이언트가 서버의 SYN/ACK를 받고 ACK를 날려 전송을 시작함을 알린다
    - 연결 종료
        - 4방향 핸드셰이크 사용
        - 1) 클라이언트가 서버에게 FIN 플래그를 전송
        - 2) 서버는 FIN을 받고 확인 메세지로 ACK를 보냄
        - 3) 서버측에서 데이터를 모두 보낸 후 통신이 끝나면 FIN 플래그를 클라이언트에게 보냄
        - 4) 클라이언트는 FIN을 확인했다는 메세지로 ACK를 보냄
        - 5) 서버는 ACK를 받고 연결을 종료함
    
    요약
    
     TCP 프로토콜은 전송 계층에 해당하며 통신을 활성화 한다
    
    전송 계층은 포트를 열어서 응용 프로그램들이 전송할 수 있도록  한다
    
    양 끝단의 사용자들이 신뢰성 있는 데이터를 주고받도록 하여 상위 계층들이 데이터 전달의 유효성이나 효율성을 생각하지 않도록 한다.
    
    오류검출 및 복구, 흐름제어, 중복검사등 패킷 손실, 중복, 순서바뀜등이 없도록 보장하여 신뢰성을 제공한다
    
    [https://asfirstalways.tistory.com/356](https://asfirstalways.tistory.com/356)
    
    [https://aws-hyoh.tistory.com/entry/TCPIP-쉽게-이해하기](https://aws-hyoh.tistory.com/entry/TCPIP-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0)
    
    [https://ko.wikipedia.org/wiki/전송_제어_프로토콜](https://ko.wikipedia.org/wiki/%EC%A0%84%EC%86%A1_%EC%A0%9C%EC%96%B4_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C)
